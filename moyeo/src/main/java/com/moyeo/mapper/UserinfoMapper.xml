<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.moyeo.mapper.UserinfoMapper">
        <!-- 회원가입 -->
        <insert id="insertUserinfo">
                INSERT INTO 
                userinfo (
                        id
                        , pw
                        , name
                        , email
                        , birth
                        , address
                        , phone
                        , regdate
                        , logdate
                        , status  
                )
                VALUES (
                        #{id}
                        , #{pw}
                        , #{name}
                        , #{email}
                        , #{birth}
                        , #{address}
                        , #{phone}
                        , sysdate
                        , sysdate
                        , #{satatus}
                )
        </insert>
        
        <!-- 로그인 -->
        <update id="updateUserinfoLogin"> 
        UPDATE user
        SET logdate= NOW()
        WHERE id= #{id}
        </update>
        
        <!-- 회원정보 변경 -->
        <update id="updateUserinfo">
                UPDATE userinfo
                <set>
                        <if test="pw != null and pw != ''">
                                pw=#{pw},
                        </if>
                        <if test="name != null and name != ''">
                                name=#{name},
                        </if>
                        <if test="email != null and email != ''">
                                email=#{email},
                        </if>
                        <if test="address != null and address != ''">
                                address=#{address},
                        </if>
                        <if test="phone != null and phone != ''">
                                phone=#{phone},
                        </if>
                        <if test="status == 0 or status == 1 or status == 2">
                                status=#{status}
                        </if>
                </set>
                WHERE id=#{id}        
        </update>

        <!-- 아이디로 유저 정보 검색 -->
        <select id="selectUserinfoById" resultType="Userinfo">
                SELECT 
                        id
                        , pw
                        , name
                        , email
                        , birth
                        , address
                        , phone
                        , regdate
                        , logdate
                        , status 
                FROM userinfo 
                WHERE id=#{id}
        </select>
        
        <!-- 전체 유저 정보 검색 -->
        <select id="selectUserinfoList" resultType="Userinfo">
                SELECT 
                        id
                        , pw
                        , name
                        , email
                        , birth
                        , address
                        , phone
                        , regdate
                        , logdate
                        , status 
                FROM userinfo ORDER BY id
        </select>
        
        <!-- 유저 정보 삭제.. 필요한가? -->
        <delete id="deleteUserinfo">
                DELETE FROM userinfo 
                WEHRE id=#{id}
        </delete>
</mapper>